(this["webpackJsonpenc.iq-online"]=this["webpackJsonpenc.iq-online"]||[]).push([[0],{208:function(t,e,n){t.exports=n.p+"static/media/dog-off.fbfd34ba.jpg"},209:function(t,e,n){t.exports=n.p+"static/media/dog-listening.add4fedf.jpg"},210:function(t,e,n){t.exports=n.p+"static/media/dog-waiting.32833b10.jpg"},211:function(t,e,n){t.exports=n.p+"static/media/dog-thinking.aae2d64d.jpg"},212:function(t,e,n){t.exports=n.p+"static/media/dog-speaking.5c1ee2e0.jpg"},222:function(t,e,n){t.exports=n(472)},227:function(t,e,n){},228:function(t,e,n){},272:function(t,e){},274:function(t,e){},304:function(t,e){},305:function(t,e){},349:function(t,e){},351:function(t,e){},374:function(t,e){},472:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),i=n(50),r=n.n(i),s=(n(227),n(23)),c=n(24),l=n(26),d=n(25),u=n(27);n(228);navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;var p=function(t,e){var n,o=function(){var t,e=!1;return{start:function(n,o,a){t||navigator.getUserMedia({audio:!0},(function(a){var i=new(window.AudioContext||window.webkitAudioContext),r=i.createMediaStreamSource(a),s=i.createScriptProcessor(4096,1,1);s.onaudioprocess=function(n){e&&t.postMessage({command:"process",inputFrame:n.inputBuffer.getChannelData(0)})},r.connect(s),s.connect(i.destination),(t=new Worker(o)).postMessage({command:"init",inputSampleRate:r.context.sampleRate}),t.onmessage=function(t){n.forEach((function(e){e.postMessage({command:"process",inputFrame:t.data})}))}}),a),e=!0},stop:function(){e=!1,t.postMessage({command:"reset"})}}}();return{start:function(a,i,r,s){(n=new Worker(t)).postMessage({command:"init",keywordIDs:a,sensitivities:i}),n.onmessage=function(t){r(t.data.keyword)},o.start([n],e,s)},stop:function(){o.stop(),n.postMessage({command:"release"})}}};var f=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).componentDidMount=function(){console.log("component mounted"),"initializing"===n.props.mood&&(n.props.moodHandler("waiting"),console.log("*** MOOD : WAITING ***"),n.startHotWordDetection())},n.componentDidUpdate=function(t){"waiting"===n.props.mood&&t.mood!==n.props.mood?(n.props.prepareForNewConversation(),console.log("*** MOOD : WAITING ***"),n.startHotWordDetection()):"off"===n.props.mood&&"waiting"===t.mood?n.stopHotWordDetection():"listening"===n.props.mood&&"waiting"===t.mood&&n.stopHotWordDetection()},n.toggleDemo=function(){"off"===n.props.mood?(n.props.moodHandler("waiting"),n.startHotWordDetection()):(n.stopHotWordDetection(),n.props.moodHandler("off"))},n.changeStateFromWaitingToListening=function(){n.props.moodHandler("listening")},n.startHotWordDetection=function(){"waiting"===n.props.mood?n.hotWordDetector.start():console.log("Waiting.js startHotWordDetection(): you cant start hotword detection because you are not in the waiting mood!")},n.stopHotWordDetection=function(){console.log("*** MOOD : OFF ***"),n.hotWordDetector.stop()},n.hotWordDetector=function(t){var e={"hey pico":new Uint8Array([40,3,128,174,86,141,96,175,20,0,38,242,45,153,191,131,165,144,101,200,6,44,199,216,91,46,77,17,27,171,153,179,206,147,49,1,83,69,108,26,173,171,19,156,203,178,212,55,89,193,90,243,31,226,185,207,218,86,47,114,124,168,81,181,226,248,11,134,14,246,12,197,195,148,68,105,108,216,245,168,201,9,65,93])},n=new Float32Array([.5,1,1,1,1,1]),o=function(e){null!==e?"hey pico"===e&&(t(),console.log("hey pico detected"),r.stop()):console.log("No hotword detected")},a="".concat("/speak","/porcupine_worker.js"),i="".concat("/speak","/downsampling_worker.js"),r=p(a,i),s=function(t){alert(t.toString())};return{start:function(){r.start(e,n,o,s)},stop:function(){r.stop(),console.log("stopped hotword detection")}}}(n.changeStateFromWaitingToListening),n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return"off"===this.props.mood?a.a.createElement("button",{onClick:this.toggleDemo},"On Demo"):a.a.createElement("button",{onClick:this.toggleDemo},"Off Demo"),a.a.createElement(a.a.Fragment,null)}}]),e}(a.a.Component),g=function(t){function e(t){var n;Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).componentDidUpdate=function(t){"listening"===n.props.mood&&t.mood!==n.props.mood?(console.log("*** MOOD : LISTENING ***"),n.handleListen()):n.recognition.stop()},n.handleListen=function(){n.recognition.start(),console.log("start of voice recognition");var t="";n.recognition.onresult=function(e){for(var o=e.resultIndex;o<e.results.length;o++){var a=e.results[o][0].transcript;e.results[o].isFinal?(t+=a+" ",n.props.queryHandler(t),n.props.moodHandler("thinking")):a}},n.recognition.onend=function(t){console.log("Speech recognition service disconnected"),"listening"===n.props.mood&&(n.props.queryHandler(""),n.props.moodHandler("thinking"))}};var o=window.SpeechRecognition||window.webkitSpeechRecognition;return n.recognition=new o,n.recognition.continous=!0,n.recognition.interimResults=!0,n.recognition.lang="en-US",n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null)}}]),e}(a.a.Component),m=n(41),h=n.n(m),w=n(205),v=n.n(w),b=n(80),y=n(206),O=n.n(y);var j=new Map;j.set("Jokes",(function(){var t,e;return h.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,t="What kind of horse only goes out at night? Nightmares",e={method:"GET",url:"https://cors-anywhere.herokuapp.com/http://icanhazdadjoke.com",headers:{"cache-control":"no-cache",Connection:"keep-alive",Referer:"http://icanhazdadjoke.com/","Accept-Encoding":"gzip, deflate","Cache-Control":"no-cache",Accept:"application/json"}},n.next=5,h.a.awrap(O()(e).then((function(t){return JSON.parse(t).joke})));case 5:return t=n.sent,n.abrupt("return",t);case 9:n.prev=9,n.t0=n.catch(0),console.log("error, ",n.t0);case 12:case"end":return n.stop()}}),null,null,[[0,9]])}));var k=function(t,e,n,o,a){var i;return h.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:j.has(e)?(console.log("intentHandler: intent handled locally"),j.get(e)(o).then((function(t){if("string"==typeof t)a(t,!1);else{var e=Object(b.a)(t,4),n=e[0],o=e[1],i=e[2],r=e[3];a(n,!1,o,i,r)}}))):(console.log("intentHandler: intent handled by dialogflow"),i=!0,i=null!==n&&void 0!==n.fields&&void 0!==n.fields.end_conversation&&n.fields.end_conversation.boolValue,a(t,i));case 1:case"end":return r.stop()}}))},H=function(t){function e(){var t,n;Object(s.a)(this,e);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(a)))).componentDidUpdate=function(t){"thinking"===n.props.mood&&t.mood!==n.props.mood&&(console.log("*** MOOD : THINKING ***"),n.handleIntent())},n.handleIntent=function(){var t,e;return h.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=n.props.query,console.log("sending query: ",t),"en-US",e={query:t,languageCode:"en-US"},o.next=6,h.a.awrap(v.a.post("https://us-central1-in-browser-voice-assistant-twb.cloudfunctions.net/dfReq",e).then((function(t){var e=t.data[0].queryResult.fulfillmentText;""===t.data[0].queryResult.fulfillmentText&&(console.log("thinking: standard fulfillment message not available"),t.data[0].queryResult.fulfillmentMessages.forEach((function(t){e.concat(t.text.text[0]),console.log(e)})));var o=t.data[0].queryResult.intent.displayName,a=t.data[0].queryResult.diagnosticInfo,i=t.data[0].queryResult.parameters.fields;console.log("intent, ",o),console.log("entities, ",JSON.stringify(i)),k(e,o,a,i,n.props.fulfillmentHandler)})).catch((function(t){console.log("err",t),n.props.fulfillmentHandler("sorry babe, I didnt hear anything. Plase say that again")})));case 6:case"end":return o.stop()}}))},n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null)}}]),e}(a.a.Component),S=function(t){function e(t){var n;Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).componentDidUpdate=function(t){if("speaking"===n.props.mood&&t.mood!==n.props.mood){console.log("*** MOOD : SPEAKING ***");var e=new window.SpeechSynthesisUtterance(n.props.fulfillmentText);window.speechSynthesis.speak(e),n.endAudio()}},n.endAudio=function(){console.log("The audio has ended"),!0===n.props.end?n.props.moodHandler("waiting"):n.props.moodHandler("listening")},n.audioHandler=function(t){n.setState({audiosrc:t})},n.getAudio=function(){console.log("getAudio()")},n.state={audiosrc:null};window.speechSynthesis;return n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("audio",{src:this.state.audiosrc,onEnded:this.endAudio,autoPlay:!0}))}}]),e}(a.a.Component),D=n(220),E=n(207),x=n(111),I=n(208),C=n.n(I),W=n(209),R=n.n(W),F=n(210),M=n.n(F),q=n(211),N=n.n(q),T=n(212),A=n.n(T),U=n(216),z=n(114);function G(){var t=Object(E.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  z-index: 0;\n\n  video {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n\n  background-color: black;\n"]);return G=function(){return t},t}var L={off:C.a,listening:R.a,waiting:M.a,thinking:N.a,speaking:A.a},X=function(t){function e(){var t,n;Object(s.a)(this,e);for(var o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return(n=Object(l.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(a)))).state={loadedImages:L,loading:!1,offsetX:!1,offsetY:!1},n.move=function(t,e){},n.componentWillMount=function(){Object.entries(L).forEach((function(t){var e=Object(b.a)(t,2),n=(e[0],e[1]),o=new Image;o.src=n,o.onload=function(){console.log(n+" loaded")}}))},n.componentWillUnmount=function(){},n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){var t=this;return a.a.createElement(a.a.Fragment,null,a.a.createElement(U.a,{start:function(){return{x:0,y:0}},update:function(){return{x:[t.props.offsetX?50:0],y:[t.props.offsetY?20:0],timing:{duration:1300,ease:t.props.offset?z.b:z.a}}}},(function(e){var n=e.x,o=e.y;return a.a.createElement(Y,{src:t.state.loadedImages[t.props.status],alt:"img",offsetX:n,offsetY:o})})))}}]),e}(o.Component),Y=Object(x.a)((function(t){var e=t.className,n=t.alt,o=t.src,i=t.offsetX,r=t.offsetY,s=Object(D.a)(t,["className","alt","src","offsetX","offsetY"]);return a.a.createElement("div",{className:e,style:{left:"".concat(i,"%"),bottom:"".concat(r,"%")}},a.a.createElement("img",Object.assign({src:o,alt:n,height:"100%",width:"100%"},s)))}))(G()),B=X,J=n(487),P=function(t){function e(t){var n;return Object(s.a)(this,e),(n=Object(l.a)(this,Object(d.a)(e).call(this,t))).moodHandler=function(t){"off"===n.state.mood&&"waiting"!==t?console.log("not allowed to change state"):n.setState({mood:t})},n.queryHandler=function(t){n.setState({query:t})},n.fulfillmentHandler=function(t,e,o,a,i){n.setState({fulfillmentText:t,end:e}),null!==a&&n.setState({showRecentSightings:a,personOfInterest:o}),null!==i&&n.setState({showTickertape:i}),n.moodHandler("speaking")},n.prepareForNewConversation=function(){n.setState({end:!1})},n.toggleDemo=function(){"off"===n.state.mood?n.moodHandler("waiting"):n.moodHandler("off")},n.startListening=function(){"waiting"===n.state.mood?n.moodHandler("listening"):console.log("not allowed to change state unless in waiting")},n.onClickRecentSightings=function(){n.state.showRecentSightings?n.setState({showRecentSightings:!1,showInhubitants:!1}):n.state.showInhubitants?n.setState({showRecentSightings:!0}):n.setState({showRecentSightings:!0,showInhubitants:!0})},n.forceHideRecentSightings=function(){n.setState({showRecentSightings:!1})},n.state={mood:"initializing",query:null,fulfillmentText:null,end:!1,showInhubitants:!1,showRecentSightings:!1,showTickertape:!1,personOfInterest:"roy"},n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(f,{mood:this.state.mood,moodHandler:this.moodHandler,prepareForNewConversation:this.prepareForNewConversation}),a.a.createElement(g,{mood:this.state.mood,moodHandler:this.moodHandler,queryHandler:this.queryHandler}),a.a.createElement(H,{mood:this.state.mood,moodHandler:this.moodHandler,query:this.state.query,fulfillmentHandler:this.fulfillmentHandler}),a.a.createElement(S,{mood:this.state.mood,moodHandler:this.moodHandler,end:this.state.end,fulfillmentText:this.state.fulfillmentText}),a.a.createElement(J.a,{style:{zIndex:"+2",position:"absolute",right:80,top:0,color:"#6C3BFF"},onClick:this.startListening},"Start Listening"),a.a.createElement(J.a,{style:{zIndex:"+2",position:"absolute",right:0,top:0,color:"#6C3BFF"},onClick:this.toggleDemo},this.state.mood),a.a.createElement(B,{status:this.state.mood,offsetX:this.state.showRecentSightings,offsetY:this.state.showTickertape}))}}]),e}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var _=n(217),K=n(486),V=Object(_.a)({palette:{type:"dark"}});r.a.render(a.a.createElement(K.a,{theme:V},a.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[222,1,2]]]);
//# sourceMappingURL=main.0fdc8e1a.chunk.js.map